#http://code.activestate.com/recipes/86900/ - Generic factory implementation